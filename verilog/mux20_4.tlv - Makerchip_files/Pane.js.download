(function(){require.config({paths:{'interact':'https://cdnjs.cloudflare.com/ajax/libs/interact.js/1.2.6/interact.min'}});define("Pane",function(require,exports,module){var $,BladeComponent,Logging,Pane,PaneComponent,PanelLabel,Promise,TabbedView,Utils,interact,livestamp;Logging=require("Logging");BladeComponent=require("BladeComponent");TabbedView=require("TabbedView");$=require("jquery");Utils=require("Utils");Promise=require("bluebird");PanelLabel=require("PanelLabel");require("livestamp");livestamp=$.fn.livestamp;interact=require("interact");PaneComponent=(function(){class PaneComponent{modelInit(){}
_createTabElement(){var closableAttr,closeEl;closableAttr=this.closable?" mc-pane-tab-closable":"";this.tabEl=$(`<a href=\"#\" data-tabbedview-ref=\"${this.mnemonic}\" `+`class=\"nav-item nav-link mc-pane-tab${closableAttr}\">${this.mnemonic}</a>`);if(this.closable){closeEl=$("<i class=\"fa fa-fw fa-times mc-pane-tab-close\"></i>").click((e)=>{e.stopPropagation();return this.close();});this.tabEl.append(closeEl);}
this._tabStatusEl=$(this._newStatusNode("none"));this.tabEl.prepend(this._tabStatusEl);return this.tabEl.click((e)=>{return this.activate();});}
initPane(bladeName,mnemonic,tabbedview,options={}){var ref;this.bladeName=bladeName;this.mnemonic=mnemonic;this.seqID=TabbedView.paneID++;TabbedView.allPanes[this.mnemonic]=this;this.path=`pane-${this.seqID}-${this.bladeName}`;if(options.closable!=null){this.closable=options.closable;}
if(this.steppable){this.steppableInit();}
this.tabPath="";options["baseApi"]=(ref=window.BASE_API_URL)!=null?ref:"";options["path"]=this.path;if(options.mnemonic==null){options.mnemonic=this.mnemonic;}
options["scalable"]=this.scalable;options["steppable"]=this.steppable;this.initPromise=this.compileComponent(this.bladeName,options).then((html)=>{this.paneEl=$(`<div class="mc-TabbedView-pane" id="${this.path}" data-tabbedview-active="false">${html}</div>"`);if(this.scalable){this.scalableInitDOM();}
if(this.steppable){this.steppableInitDOM();}
this.tabEl=this._createTabElement();return this;}).catch(function(err){return console.log(err);});if(tabbedview!=null){return this.open(tabbedview);}else{return this.initPromise;}}
open(tabbedview1){this.tabbedview=tabbedview1;this.opened="pending";return this.initPromise.then((thisPane)=>{this.opened=true;if(this.tabbedview instanceof TabbedView){this.tabbedview.append(this);}else{this.active=true;this.tabbedview.append(this.paneEl);}
return this.initOpened();});}
initOpened(){return Promise.resolve(this);}
resize(){}
enableTimestamp(){var now;now=new Date();this.timestampMode="static";this.timestampEl=$(`<div id=\"${this.path}-timestamp\" data-panelstatus=\"data-PanelStatus\"`+` data-mode=\"${this.timestampMode}\" class=\"no-select\">`+"<span class=\"staticStr\">Not compiled.</span>"+"<span class=\"prefix\">Last updated </span>"+"<span class=\"timestamp\"></span>"+"</div>");this.paneEl.append(this.timestampEl);$(".timestamp",this.timestampEl).livestamp(new Date());return this.timestampEnabled=true;}
updateTimestamp(){$(".timestamp",this.timestampEl).livestamp(new Date());if(this.timestampMode!=="time"){this.timestampMode="time";}
return this.timestampEl.attr("data-mode",this.timestampMode);}
getTabPosition(){return this.tabbedview.getPosition(this.tabEl);}
_newStatusNode(tabstatus){this.tabstatus=tabstatus;return TabbedView.statusEl[this.tabstatus].cloneNode(true);}
setStatus(tabstatus){var el;this.tabstatus=tabstatus;el=this._newStatusNode(this.tabstatus);this._tabStatusEl.replaceWith(el);this._tabStatusEl=$(el);this._tabStatusEl.attr("data-status",this.tabstatus);if(this.timestampEnabled&&((this.tabstatus==="success")||(this.tabstatus==="fail"))){return this.updateTimestamp();}}
addLabel(options){this.label=new PanelLabel();return this.label.init(this,options);}
hideLabel(){var el;if(this.label.hidden){return;}
this.label.hide();el=this.paneEl;return el.on("mousemove",()=>{if(!this.label.hidden){return;}
this.label.show();return el.off("mousemove");});}
setTabActive(state){if(this.active!==state){this.active=state;if(state){return Utils.node(this.tabEl).classList.add("active");}else{return Utils.node(this.tabEl).classList.remove("active");}}}
activate(){return this.tabbedview.activatePane(this);}
close(){this.tabbedview.dissociate(this);this.paneEl.detach();this.tabEl.detach();this.opened=false;return this;}};PaneComponent.prototype.seqID=null;PaneComponent.prototype.bladeName=null;PaneComponent.prototype.mnemonic=null;PaneComponent.prototype.closable=false;PaneComponent.prototype.scalable=false;PaneComponent.prototype.steppable=false;PaneComponent.prototype.initPromise=null;PaneComponent.prototype.paneEl=null;PaneComponent.prototype.tabEl=null;PaneComponent.prototype.timeEl=null;PaneComponent.prototype._tabStatusEl=null;PaneComponent.prototype.tabbedview=null;PaneComponent.prototype.alwaysInDOM=true;PaneComponent.prototype.opened=false;PaneComponent.prototype.active=false;PaneComponent.prototype.timestampEnabled=false;PaneComponent.prototype.label=null;PaneComponent.prototype.tabstatus="none";return PaneComponent;}).call(this);PaneComponent.Rect=(function(){class Rect{constructor(){}
set(x1,y1,width,height){this.x=x1;this.y=y1;this.width=width;this.height=height;this.x2=this.x+this.width;this.y2=this.y+this.height;return this;}};Rect.prototype.x=null;Rect.prototype.y=null;Rect.prototype.x2=null;Rect.prototype.y2=null;Rect.prototype.width=null;Rect.prototype.height=null;return Rect;}).call(this);Pane=(function(){class Pane extends PaneComponent{initPane(bladeName,mnemonic,ide,project,tabbedview,options={}){this.bladeName=bladeName;this.mnemonic=mnemonic;this.ide=ide;this.project=project;return super.initPane(this.bladeName,this.mnemonic,tabbedview,options);}};Pane.prototype.ide=null;Pane.prototype.project=null;return Pane;}).call(this);Pane.Scalable={scalable:true,contentContainerEl:null,content:null,dragging:false,ZOOM_BUTTON_MASK:4,ZOOM_SLUGGISHNESS:30,PINCH_SLUGGISHNESS:30,WHEEL_ZOOM_SLUGGISHNESS_PIXELS:200,WHEEL_ZOOM_SLUGGISHNESS_LINES:10,WHEEL_ZOOM_SLUGGISHNESS_PAGES:1,scalableInitDOM:function(){var buttonZoomSensitivity,keyboardZoom,keyboardZoomSensitivity,keycode,scalingEls;scalingEls=$(`<div role="group" data-${this.mnemonic}-zooming="data-${this.mnemonic}-zooming"
     class="btn-group mc-pane-controls mc-zooming-controls" id="${this.path}-zoom">
  <button data-${this.mnemonic}-zoom="in" title="Zoom In" class="btn btn-secondary">
    <i class="fa fa-fw fa-plus"></i></button>
  <button data-${this.mnemonic}-zoom="out" title="Zoom Out" class="btn btn-secondary">
    <i class="fa fa-fw fa-minus"></i></button>
  <button data-${this.mnemonic}-zoom="reset" title="Reset Zoom" class="btn btn-secondary">
    <i class="fa fa-fw fa-expand"></i></button>
</div><div class="mc-scalable-container"><div>`);this.paneEl[0].children[0].appendChild(scalingEls[0]);this.contentContainerEl=$(this.paneEl[0].children[0].appendChild(scalingEls[1]));interact(`#${this.path} .mc-scalable-container`).draggable({inertia:true}).gesturable({onmove:(e)=>{e.preventDefault();if(this.content!==null&&this.content.contentValid){return this.content.zoomContentBy(1+e.ds/this.PINCH_SLUGGISHNESS);}}}).on('touchmove',function(e){return e.preventDefault();}).on('dragstart',(e)=>{return this.dragging=true;}).on('dragend',(e)=>{return setTimeout((()=>{return this.dragging=false;}),0);}).on('dragmove',(e)=>{e.preventDefault();if(this.content!==null&&this.content.contentValid){if((e.buttons&this.ZOOM_BUTTON_MASK)!==0){return this.content.zoomContentBy-e.dy/this.ZOOM_SLUGGISHNESS;}else{return this.content.panContentBy(e.dx,e.dy);}}});this.contentContainerEl.on("wheel",(e)=>{var amt,sluggishness,userX,userY;e.preventDefault();if((e.originalEvent==null)||(e.originalEvent.deltaY==null)||(e.originalEvent.deltaMode==null)){return;}
if(this.content!==null&&this.content.contentValid){sluggishness=e.originalEvent.deltaMode===0?this.WHEEL_ZOOM_SLUGGISHNESS_PIXELS:e.originalEvent.deltaMode===1?this.WHEEL_ZOOM_SLUGGISHNESS_LINES:this.WHEEL_ZOOM_SLUGGISHNESS_PAGES;amt=-e.originalEvent.deltaY/sluggishness;({userX,userY}=this.userCoordsOfContainerEvent(e));return this.content.zoomContentByAt(amt,userX,userY);}});keyboardZoomSensitivity=0.5;keycode={leftBracket:219,rightBracket:221,equals:187,minus:189,kpMinus:109,kpPlus:107};keyboardZoom=(e)=>{var ref,ref1;if(!this._zoomListening){return;}
if(this.content!==null&&this.content.contentValid){if((ref=e.keyCode)===keycode.rightBracket||ref===keycode.equals||ref===keycode.kpPlus){this.content.zoomContentBy(keyboardZoomSensitivity);}
if((ref1=e.keyCode)===keycode.leftBracket||ref1===keycode.minus||ref1===keycode.kpMinus){return this.content.zoomContentBy(-1*keyboardZoomSensitivity);}}};this.contentContainerEl.on("mouseenter",(e)=>{if(this._zoomListening){return;}
$(document).on('keydown',keyboardZoom);return this._zoomListening=true;});this.contentContainerEl.on("mouseleave",(e)=>{$(document).off("keydown",keyboardZoom);return this._zoomListening=false;});buttonZoomSensitivity=0.25;Utils.$one(`[data-${this.mnemonic}-zoom='in']`,this.paneEl).click((e)=>{e.preventDefault();if(this.content!==null&&this.content.contentValid){return this.content.zoomContentBy(buttonZoomSensitivity);}});Utils.$one(`[data-${this.mnemonic}-zoom='out']`,this.paneEl).click((e)=>{e.preventDefault();if(this.content!==null&&this.content.contentValid){return this.content.zoomContentBy(-1*buttonZoomSensitivity);}});return Utils.$one(`[data-${this.mnemonic}-zoom='reset']`,this.paneEl).click((e)=>{e.preventDefault();if(this.content!==null&&this.content.contentValid){this.content.centerContent(false);return this.content.setContentScale(1.0);}});},userCoordsOfContainerEvent:function(e){var bounds,el,ret;el=this.contentContainerEl[0];bounds=el.getBoundingClientRect();ret={userX:this.content.userFocus.x+this.content.pixelsToUserUnits(e.pageX-(bounds.left+bounds.right)/2.0),userY:this.content.userFocus.y+this.content.pixelsToUserUnits(e.pageY-(bounds.top+bounds.bottom)/2.0)};return ret;}};Pane.ScalableContent=(function(){class ScalableContent{constructor(pane){this.construct(pane);}
construct(pane1){this.pane=pane1;return this.contentContainerEl=this.pane.contentContainerEl;}
initContent(){return Utils.abstractMethod();}
centerContent(refresh=true){var contentCenterX,contentCenterY;contentCenterX=(this.userBounds.x+this.userBounds.x2)/2.0;contentCenterY=(this.userBounds.y+this.userBounds.y2)/2.0;return this.focusContentOn(contentCenterX,contentCenterY,refresh);}
zoomContentBy(exp,refresh=true){return this.setContentScale(this.contentScale*Math.pow(2,exp),refresh);}
zoomContentByAt(exp,userX,userY,refresh=true){var scaling_factor;this.zoomContentBy(exp,false);scaling_factor=Math.pow(2,exp);return this.focusContentOn(this.userFocus.x+(userX-this.userFocus.x)*(scaling_factor-1.0)/scaling_factor,this.userFocus.y+(userY-this.userFocus.y)*(scaling_factor-1.0)/scaling_factor,refresh);}
panContentBy(d_left,d_top,refresh=true){return this.focusContentOn(this.userFocus.x-this.pixelsToUserUnits(d_left),this.userFocus.y-this.pixelsToUserUnits(d_top),refresh);}
focusContentOn(x,y,refresh=true){if(x>this.userBounds.x2){x=this.userBounds.x2;}
if(x<this.userBounds.x){x=this.userBounds.x;}
if(y>this.userBounds.y2){y=this.userBounds.y2;}
if(y<this.userBounds.y){y=this.userBounds.y;}
this.userFocus={x,y};if(refresh){return this.refreshContentPosition();}}
positionNewContent(){if(this.is_first){return this.centerContent();}else{return this.focusContentOn(this.userFocus.x,this.userFocus.y);}}
setContentScale(scale,refresh=true){this.contentScale=scale;if(refresh){return this.refreshContentPosition();}}
refreshContentPosition(){return Utils.abstractMethod();}
pixelsToUserUnits(px){return Utils.abstractMethod();}
destroy(){}};ScalableContent.prototype.contentContainerEl=null;ScalableContent.prototype.pane=null;ScalableContent.prototype.contentValid=false;ScalableContent.prototype.userBounds=null;ScalableContent.prototype.userFocus=null;ScalableContent.prototype.contentScale=1.0;ScalableContent.prototype.is_first=true;return ScalableContent;}).call(this);Pane.ScalableSVG=(function(){class ScalableSVG extends Pane.ScalableContent{constructor(pane){super(pane);}
setBounds(viewbox){return Utils.abstractMethod();}
newSVG(_newSVG){var str,svgEl,viewBox;svgEl=$(_newSVG);svgEl=svgEl.filter("svg");if(svgEl.length!==1){return this.pane.setStatus("fail");}else{this.contentValid=true;this.pane.setStatus("success");this.svgDOMEl=svgEl.get(0);this.gDOMEl=Utils.$one(svgEl.children("g"));Utils.assert(this.gDOMEl.length===1);viewBox=this.svgDOMEl.viewBox.baseVal;this.userBounds=new PaneComponent.Rect();this.setBounds(viewBox);str=-(this.userBounds.width/2.0)+" "+-(this.userBounds.height/2.0)+" "+this.userBounds.width+" "+this.userBounds.height;this.svgDOMEl.setAttribute("viewBox",str);this.positionNewContent();this.contentContainerEl.children().replaceWith(svgEl);if(this.is_first){this.initContent();}
return this.is_first=false;}}
pixelsToUserUnits(px){var clientHeight,clientWidth,if_x_bound,if_y_bound;({clientWidth,clientHeight}=this.contentContainerEl[0]);if_x_bound=this.userBounds.width/clientWidth;if_y_bound=this.userBounds.height/clientHeight;return px*Math.max(if_x_bound,if_y_bound)/this.contentScale;}
refreshContentPosition(){var str;str=`scale(${this.contentScale}) rotate(0) translate(${-this.userFocus.x} ${-this.userFocus.y})`;return this.gDOMEl.attr("transform",str);}
parseGTransform(){var all,focus,re,rotate,scale,str;focus={};str=this.gDOMEl.attr("transform");re=/scale\(([0-9\.-]+)(?:\s[0-9\.-]+)?\)\srotate\(([0-9\.-]+)\)\stranslate\(([0-9\.-]+)\s([0-9\.-]+)\)/;[all,scale,rotate,focus.x,focus.y]=str.match(re);scale=parseInt(scale,10);rotate=parseInt(rotate,10);focus.x=-parseInt(focus.x,10);focus.y=-parseInt(focus.y,10);return{scale,rotate,focus};}};ScalableSVG.prototype.gDOMEl=null;return ScalableSVG;}).call(this);Pane.Steppable={steppable:true,cyc:null,cycEl:null,waveData:null,steppableInit:function(){return this.cyc=0;},steppableInitDOM:function(){var stepEl;this.cycEl=$(`<textarea title="Current Cycle" id="${this.path}-cyc" style="resize: none; height: 30px; width: 100px;">
  ${this.cyc}</textarea>`);this.cycEl.on("keypress",(e)=>{if(e.which===13){this.validateCyc();return e.preventDefault();}});this.cycEl.on("focusout",()=>{return this.validateCyc();});stepEl=$(`<div role="group" data-${this.mnemonic}-stepping="data-${this.mnemonic}-stepping"
     class="btn-group mc-pane-controls mc-stepping-controls" id="${this.path}-step">
  <button data-${this.mnemonic}-step="back" title="Step Back" class="btn btn-secondary">
    <i class="fa fa-fw fa-chevron-left"></i></button>
  <button data-${this.mnemonic}-step="forward" title="Step" class="btn btn-secondary">
    <i class="fa fa-fw fa-chevron-right"></i></button>
  <button data-${this.mnemonic}-reset="data-viz-reset" title="Jump to start" class="btn btn-secondary">
    <i class="fa fa-fw fa-step-backward"></i></button>
  <span style="position: relative; top: -10px">Cycle:</span>
</div>`);Utils.$one("[data-viz-step='forward']",stepEl).click((e)=>{e.preventDefault();return this.nextCycle();});Utils.$one("[data-viz-step='back']",stepEl).click((e)=>{e.preventDefault();return this.prevCycle();});Utils.$one("[data-viz-reset]",stepEl).click((e)=>{e.preventDefault();return this.setCycle(0);});stepEl[0].appendChild(this.cycEl[0]);return this.paneEl[0].children[0].appendChild(stepEl[0]);},getWaveData:function(){return this.waveData;},setWaveData:function(waveData){this.waveData=waveData;return this.setCycle(this.cyc);},prevCycle:function(){return this.setCycle(this.cyc-1);},nextCycle:function(){return this.setCycle(this.cyc+1);},setCycle:function(newCyc,min=0,max){if(max==null){max=this.getWaveData()?this.getWaveData().getEndCycle():min;}
if(newCyc<min){newCyc=min;}
if(newCyc>max){newCyc=max;}
this.cycEl.val(`${newCyc}`);if(this.cyc!==newCyc){this.updateCyc(newCyc);return Utils.assert(this.cyc===newCyc);}},validateCyc:function(){var cycStr,newCyc;cycStr=this.cycEl.val();newCyc=parseInt(cycStr,10);if(!isNaN(newCyc)&&newCyc>=0){return this.setCycle(newCyc);}else{return this.setCycle(this.cyc);}}};Utils.extend(Pane,module.config());Utils.extend(Pane,BladeComponent);return Pane;});}).call(this);